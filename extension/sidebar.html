<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      button {
        width: 30%;
        height: 25px;
        margin: auto;
        text-align: center;
        background-color: #ADD8E6;
        border: 2px solid #A9A9A9;
        border-radius: 25px;
        display: block;
      }
      button:hover {
        transform: scale(1.1);
      }
    </style>
  </head>
  <body>
    <button id="b1">ziskej text</button>


<script>
  // variables
  const btn1 = document.getElementById("b1")
  const textDokumentu = []
  // functions
  btn1.addEventListener("click", getParagraphsText)

  function getParagraphsText() {
    google.script.run
      .withSuccessHandler(onSuccess)
      .withFailureHandler(onFailure)
      .extractTextFromParagraphs()
  }

  function onSuccess(result){
    formatText(result)
  }
  function onFailure(result){
    console.log("Fail", result)
  }
  
  function formatText(text) {
    text.forEach(p => {
      if(p !== ""){
        let txt = p.split(/[ .,?!()\s]+/)
        txt.forEach( x => textDokumentu.push(x))
      }
    })
    //textDokumentu.filter(x => x !== "" || x !== " ")
    console.log(textDokumentu)
    sendDataToServer(textDokumentu)
  }

  // server communication
  function sendDataToServer(result) {
    fetch('http://127.0.0.1:8000/api/process-sentence/', {
      method: 'POST',
      headers: {
      'Content-Type': 'application/json'
      },
      body: JSON.stringify({ sentence: result }) 
    })
  .then(response => response.json())
  .then(data => console.log('Success:', data))
  .catch(error => console.error('Error:', error));
  }
</script>
</body>
</html>